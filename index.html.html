<!doctype html>
<html lang="sk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Setlist ‚Äî iOS vzhƒæad</title>

<!-- iOS-like font stack -->
<style>
  :root{
    --bg:#0b1220;
    --card: rgba(255,255,255,0.06);
    --glass: rgba(255,255,255,0.06);
    --accent: #0a84ff; /* iOS blue */
    --text: #f7f7fa;
    --muted: rgba(247,247,250,0.65);
    --radius: 14px;
  }

  /* Page */
  html,body{height:100%;}
  body{
    margin:0;
    font-family:-apple-system, "SF Pro Text", "SF Pro Display", "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: radial-gradient(1200px 600px at 10% 20%, rgba(10,132,255,0.06), transparent),
                radial-gradient(900px 400px at 90% 80%, rgba(255,45,85,0.04), transparent),
                var(--bg);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:20px;
    box-sizing:border-box;
    display:flex;
    justify-content:center;
    align-items:flex-start;
  }

  /* Sparkle animated overlay */
  .sparkles{
    position:fixed;
    inset:0;
    pointer-events:none;
    background-image: radial-gradient(circle at 10% 10%, rgba(255,255,255,0.04) 0 2px, transparent 3px),
                      radial-gradient(circle at 80% 30%, rgba(255,255,255,0.03) 0 1.5px, transparent 2px);
    mix-blend-mode:screen;
    animation: drift 12s linear infinite;
    opacity:0.9;
  }
  @keyframes drift{
    0%{transform:translateY(0) rotate(0deg);}
    50%{transform:translateY(-20px) rotate(30deg);}
    100%{transform:translateY(0) rotate(0deg);}
  }

  /* App container */
  .app{
    width:100%;
    max-width:740px;
    margin-top:30px;
  }

  header{
    display:flex;
    align-items:baseline;
    gap:12px;
    margin-bottom:18px;
  }
  .title{
    font-size:28px;
    font-weight:700;
    letter-spacing:-0.02em;
  }
  .subtitle{
    color:var(--muted);
    font-size:13px;
  }

  /* Card */
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border-radius:var(--radius);
    padding:18px;
    box-shadow: 0 6px 18px rgba(2,6,23,0.6);
    backdrop-filter: blur(10px) saturate(120%);
    border: 1px solid rgba(255,255,255,0.04);
  }

  /* Input area */
  .input-row{
    display:flex;
    gap:12px;
    align-items:center;
  }
  .text-input{
    flex:1;
    min-width:0;
    padding:12px 14px;
    border-radius:12px;
    border: 1px solid rgba(255,255,255,0.06);
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    color:var(--text);
    font-size:16px;
    outline:none;
    box-shadow: inset 0 -1px 0 rgba(0,0,0,0.25);
  }
  .text-input::placeholder{color:rgba(247,247,250,0.45);}

  .btn{
    padding:10px 14px;
    border-radius:999px;
    border:none;
    font-weight:600;
    font-size:15px;
    cursor:pointer;
    display:inline-flex;
    gap:8px;
    align-items:center;
    justify-content:center;
  }
  .btn-primary{
    background: linear-gradient(180deg,var(--accent), #0060d6);
    color:white;
    box-shadow: 0 6px 14px rgba(10,132,255,0.18), inset 0 -1px rgba(0,0,0,0.12);
  }
  .btn-ghost{
    background:transparent;
    color:var(--muted);
    border:1px solid rgba(255,255,255,0.03);
  }

  /* List */
  .list{
    margin-top:14px;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .item{
    display:flex;
    align-items:center;
    gap:12px;
    padding:10px;
    border-radius:12px;
    background: rgba(255,255,255,0.02);
    border:1px solid rgba(255,255,255,0.02);
  }
  .item .label{
    flex:1;
    min-width:0;
    font-size:16px;
    word-break:break-word;
    color:var(--text);
  }
  .item input.edit{
    flex:1;
    min-width:0;
    padding:8px 10px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.06);
    background:transparent;
    color:var(--text);
    font-size:16px;
  }
  .controls{
    display:flex;
    gap:8px;
    align-items:center;
  }
  .icon{
    width:36px;
    height:36px;
    border-radius:10px;
    display:inline-grid;
    place-items:center;
    cursor:pointer;
    font-size:15px;
    color:var(--muted);
    border:1px solid rgba(255,255,255,0.02);
    background:transparent;
  }
  .icon:hover{color:var(--text); transform:translateY(-1px);}

  /* small helper text */
  .hint{
    margin-top:10px;
    color:var(--muted);
    font-size:13px;
  }

  /* Print-friendly styles */
  @media print{
    body *{visibility:hidden;}
    #print-area, #print-area *{visibility:visible;}
    #print-area{position:fixed;left:0;top:0;width:100%;}
    .no-print{display:none !important;}
  }
</style>
</head>
<body>

<div class="sparkles" aria-hidden="true"></div>

<div class="app">
  <header>
    <div>
      <div class="title">Setlist</div>
      <div class="subtitle">r√Ωchlo pridaj veci ‚Äî exportuj ako PDF (iOS vzhƒæad)</div>
    </div>
  </header>

  <section class="card" aria-label="Setlist editor">
    <div class="input-row">
      <input id="mainInput" class="text-input" type="text" placeholder="Sem nap√≠≈° n√°zov (napr. Skl√≠ƒçka dotykov)" aria-label="Nov√° polo≈æka">
      <button id="addBtn" class="btn btn-primary" title="Prida≈•">Prida≈•</button>
      <button id="exportBtn" class="btn btn-ghost no-print" title="Exportova≈• do PDF">Exportova≈• ako PDF</button>
    </div>

    <div class="list" id="list" aria-live="polite" aria-label="Zoznam polo≈æiek">
      <!-- polo≈æky sa pridaj√∫ sem -->
    </div>

    <div class="hint">M√¥≈æe≈° upravova≈•, vymaz√°va≈• alebo presun√∫≈• polo≈æky hore/dole. Na iOS v dial√≥gu vytlaƒçi≈• -> ulo≈æi≈• ako PDF.</div>
  </section>
</div>

<!-- Hidden printable area used for generating print/PDF -->
<div id="print-area" style="display:none;"></div>

<script>
  // Simple setlist manager
  (function(){
    const input = document.getElementById('mainInput');
    const addBtn = document.getElementById('addBtn');
    const listEl = document.getElementById('list');
    const exportBtn = document.getElementById('exportBtn');
    const printArea = document.getElementById('print-area');

    // Load from localStorage (persistent)
    const STORAGE_KEY = 'setlist_items_v1';
    let items = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

    // Render function
    function render(){
      listEl.innerHTML = '';
      items.forEach((text, idx) => {
        const it = document.createElement('div');
        it.className = 'item';
        it.dataset.index = idx;

        const label = document.createElement('div');
        label.className = 'label';
        label.textContent = text;

        const editInput = document.createElement('input');
        editInput.type = 'text';
        editInput.className = 'edit';
        editInput.value = text;
        editInput.style.display = 'none';

        // controls
        const controls = document.createElement('div');
        controls.className = 'controls';

        // edit button
        const btnEdit = document.createElement('button');
        btnEdit.className = 'icon';
        btnEdit.title = 'Upravi≈•';
        btnEdit.innerHTML = '‚úèÔ∏è';
        btnEdit.addEventListener('click', () => {
          if(editInput.style.display === 'none'){
            editInput.style.display = '';
            label.style.display = 'none';
            editInput.focus();
            btnEdit.innerHTML = 'üíæ'; // save icon
            btnEdit.title = 'Ulo≈æi≈•';
          } else {
            const v = editInput.value.trim();
            if(v===''){ alert('N√°zov nesmie by≈• pr√°zdny'); editInput.focus(); return; }
            items[idx] = v;
            save();
            render();
          }
        });

        // delete button
        const btnDelete = document.createElement('button');
        btnDelete.className = 'icon';
        btnDelete.title = 'Vymaza≈•';
        btnDelete.innerHTML = 'üóëÔ∏è';
        btnDelete.addEventListener('click', () => {
          if(confirm('Naozaj vymaza≈• t√∫to polo≈æku?')) {
            items.splice(idx,1);
            save();
            render();
          }
        });

        // move up
        const btnUp = document.createElement('button');
        btnUp.className = 'icon';
        btnUp.title = 'Presun√∫≈• hore';
        btnUp.innerHTML = '‚¨ÜÔ∏è';
        btnUp.addEventListener('click', () => {
          if(idx>0){
            [items[idx-1], items[idx]] = [items[idx], items[idx-1]];
            save();
            render();
          }
        });

        // move down
        const btnDown = document.createElement('button');
        btnDown.className = 'icon';
        btnDown.title = 'Presun√∫≈• dole';
        btnDown.innerHTML = '‚¨áÔ∏è';
        btnDown.addEventListener('click', () => {
          if(idx < items.length-1){
            [items[idx+1], items[idx]] = [items[idx], items[idx+1]];
            save();
            render();
          }
        });

        controls.appendChild(btnUp);
        controls.appendChild(btnDown);
        controls.appendChild(btnEdit);
        controls.appendChild(btnDelete);

        it.appendChild(label);
        it.appendChild(editInput);
        it.appendChild(controls);

        listEl.appendChild(it);
      });

      // If empty, show placeholder
      if(items.length===0){
        const empty = document.createElement('div');
        empty.style.color = 'var(--muted)';
        empty.style.padding = '16px';
        empty.style.textAlign = 'center';
        empty.textContent = 'Zoznam je pr√°zdny ‚Äî pridaj prv√∫ polo≈æku.';
        listEl.appendChild(empty);
      }
    }

    function save(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
    }

    // Add item
    addBtn.addEventListener('click', () => {
      const v = input.value.trim();
      if(!v) return;
      items.push(v);
      save();
      render();
      input.value = '';
      input.focus();
    });

    // Enter to add
    input.addEventListener('keydown', (e) => {
      if(e.key === 'Enter'){ e.preventDefault(); addBtn.click(); }
    });

    // Export to PDF via print-friendly new window (keeps diacritics)
    exportBtn.addEventListener('click', () => {
      if(items.length===0){ alert('Zoznam je pr√°zdny ‚Äî niƒç na export.'); return; }

      // build print HTML
      const title = 'Setlist';
      const html = buildPrintHtml(title, items);
      // open new window and print
      const w = window.open('', '_blank');
      if(!w){
        alert('Prehliadaƒç zablokoval vyskakovacie okn√°. Umo≈æni otv√°ranie vyskakovac√≠ch okien pre t√∫to str√°nku.');
        return;
      }
      w.document.open();
      w.document.write(html);
      w.document.close();

      // wait a short moment to let fonts render, then print
      w.focus();
      setTimeout(() => {
        w.print();
        // do not auto-close ‚Äî user may want to save. Some browsers disallow close().
      }, 450);
    });

    function buildPrintHtml(title, items){
      // simple clean printable layout with UTF-8 meta so diacritika zostane
      const now = new Date();
      const dateStr = now.toLocaleString();
      const itemHtml = items.map((t,i) => `<div style="font-size:18px; margin:6px 0;"><strong>${i+1}.</strong> ${escapeHtml(t)}</div>`).join('');
      return `<!doctype html>
<html lang="sk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>${escapeHtml(title)}</title>
<style>
  body{font-family:-apple-system,"SF Pro Text","Helvetica Neue",Arial, sans-serif; padding:28px; color:#111;}
  h1{font-size:26px; margin-bottom:6px;}
  .meta{color:#555; margin-bottom:18px;}
  .list{margin-top:10px;}
</style>
</head>
<body>
  <h1>${escapeHtml(title)}</h1>
  <div class="meta">Export: ${escapeHtml(dateStr)}</div>
  <div class="list">
    ${itemHtml}
  </div>
</body>
</html>`;
    }

    // minimal HTML escaping
    function escapeHtml(s){ return (s+'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

    // initial render
    render();

    // expose for debugging (optional)
    window.__setlist = {
      get: () => items.slice(),
      add: (t)=>{ items.push(t); save(); render(); }
    };

  })();
</script>
</body>
</html>
